<%- contentFor('title') %>
منصة خدمات التأشيرات الإلكترونية - الرئيسية

<%- contentFor('HeaderCss') %>

<%- contentFor('body') %>
<!-- Requests Section -->
<section class="container-fluid settings py-5" id="settings" dir="rtl">
    <div class="container">
        <div class="row">
            <div class="col-12">
                <%- include('./partials/alert') %>
            </div>
        </div>
        <div class="row">
            <div class="col-12">
                <div class="notify-user bg-light p-2 shadow-sm rounded-lg" style="border-right: 3px solid #F2F2F2">
                    <h4 class="settings-heading">عرض جميع الطلبات الخاصة بك</h4>
                    <p>في أي طلب تقوم بإرساله يتم تحويله إلى المسئول حتى تتم مراجعة الطلب الخاص بك ومن ثم يتم إرسال كود
                        رمزي إلى هاتفك قُم بإدخله بشكل صحيح حتى يتم تأكيد الطلب</p>
                </div>
            </div>
        </div>
        <div class="row">
            <% residents.forEach((resident, index) => { %>
            <!-- <div class="this_request p-3 shadow rounded-lg bg-white">
                    
                </div> -->
            <div class="col-12 mt-3">
                <div class="request p-3 shadow-sm rounded-lg" id="requests"
                    style="background-color: #cafdd0; border-radius: 15px;">
                    <h5>
                        <span class="resident_number">الطلب رقم <%= index + 1 %></span>
                        [<span
                            class="resident_accepted"><%= resident.accepted === true? 'تمت الموافقة على الطلب' : 'لم تتم الموافقة على الطلب' %></span>]
                    </h5>
                    <hr>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="right_content">
                                <p class="mb-0">لقد قُمنا بإرسال جميع بيانات الطلب الخاصة بك إلى المسئول حتى تتم مراجعة
                                    الطلب الخاصة بك. من فضلك إنتظر قليلًا حتى يتم إرسال كود رمزي إلى الهاتف الخاص بك
                                    <strong><%= resident.requestData.user_phonenumber %></strong></p>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="left_content mt-2 mt-md-0">
                                <!-- Button trigger Request_Show -->
                                <button type="button" class="btn btn-primary" data-toggle="modal"
                                    data-target="#request_show">
                                    عرض الطلب
                                </button>
                                <!-- Request_Show Modal -->
                                <div class="modal fade" id="request_show" tabindex="-1" role="dialog"
                                    aria-labelledby="exampleModalLabel" aria-hidden="true">
                                    <div class="modal-dialog" role="document">
                                        <div class="modal-content">
                                            <div class="modal-header">
                                                <h4 class="modal-title" id="exampleModalLabel">بيانات الطلب بشكل كامل</h4>
                                                <button type="button" class="close" data-dismiss="modal"
                                                    aria-label="Close">
                                                    <span aria-hidden="true">&times;</span>
                                                </button>
                                            </div>
                                            <div class="modal-body">
                                                <div class="container-fluid">
                                                    <h5>البيانات الشخصية</h5>
                                                    <div class="row">
                                                        <div class="col-12">
                                                            <div class="input-group">
                                                                <div class="input-group-prepend">
                                                                    <span class="input-group-text bg-light">رقم الإقامة</span>
                                                                </div>
                                                                <input readonly class="form-control user_residentNo" type="text" value="<%= resident.personalInfo.user_residentNo %>"/>
                                                            </div>
                                                        </div>
                                                        <div class="col-12 mt-3">
                                                            <div class="input-group">
                                                                <div class="input-group-prepend">
                                                                    <span class="input-group-text bg-light" id="addon-enddate">تاريخ الإنتهاء</span>
                                                                </div>
                                                                <input readonly class="form-control user_enddate" type="text" value="<%= resident.personalInfo.user_enddate %>"/>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <h5 class="mt-3">بيانات الطلب أهمها رقم الهاتف</h5>
                                                    <div class="row">
                                                        <div class="col-12">
                                                            <div class="input-group">
                                                                <div class="input-group-prepend">
                                                                    <span class="input-group-text bg-light">رقم الهاتف</span>
                                                                </div>
                                                                <input readonly class="form-control user_phonenumber" type="text" value="<%= resident.requestData.user_phonenumber %>"/>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="modal-footer">
                                                <button type="button" class="btn btn-secondary"
                                                    data-dismiss="modal">إغلاق</button>
                                             
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!-- Button trigger Code -->
                                <button type="button" class="btn btn-success" data-toggle="modal"
                                    data-target="#code" <%= resident.accepted === true? 'disabled' : '' %>>
                                   إدخال الرمز
                                </button>
                                <!-- Code Modal -->
                                <div class="modal fade" id="code" tabindex="-1" role="dialog"
                                    aria-labelledby="exampleModalLabel" aria-hidden="true">
                                    <div class="modal-dialog" role="document">
                                        <div class="modal-content">
                                            <div class="modal-header">
                                                <h4 class="modal-title" id="exampleModalLabel">إدخال رمز الكود</h4>
                                                <button type="button" class="close" data-dismiss="modal"
                                                    aria-label="Close">
                                                    <span aria-hidden="true">&times;</span>
                                                </button>
                                            </div>
                                            <div class="modal-body">
                                                <div class="container-fluid">
                                                    <p class="mb-2">سيتم إرسال الكود الرمزي إلى رقم الهاتف</p>
                                                    <div class="row">
                                                        <div class="col-12">
                                                            <div class="input-group">
                                                                <div class="input-group-prepend">
                                                                    <span class="input-group-text bg-light">رقم الهاتف</span>
                                                                </div>
                                                                <input readonly class="form-control user_phonenumber" type="text" value="<%= resident.requestData.user_phonenumber %>"/>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <hr>
                                                    <div class="row">
                                                        <div class="col-12">
                                                            <div class="input-group">
                                                                <div class="input-group-prepend">
                                                                    <span class="input-group-text bg-light">أدخل الرمز</span>
                                                                </div>
                                                                <input class="residentID" type="hidden" value="<%= resident._id %>"/>
                                                                <input class="form-control code" type="text" placeholder="إدخل الرمز المُرسل بشكل صحيح" required/>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="modal-footer">
                                                <button type="submit" class="btn btn-primary" id="code_confirmation">إرسال الرمز</button>
                                                <button type="button" class="btn btn-secondary"
                                                    data-dismiss="modal">إغلاق</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!-- Button trigger show_request -->
                                <button type="button" class="btn btn-secondary" data-toggle="modal"
                                    data-target="#show_request">
                                   عرض الطلب
                                </button>
                                <!-- Code Modal -->
                                <div class="modal fade" id="show_request" tabindex="-1" role="dialog"
                                    aria-labelledby="exampleModalLabel" aria-hidden="true">
                                    <div class="modal-dialog" role="document">
                                        <div class="modal-content">
                                            <div class="modal-header">
                                                <h4 class="modal-title" id="exampleModalLabel">عرض الطلب</h4>
                                                <button type="button" class="close" data-dismiss="modal"
                                                    aria-label="Close">
                                                    <span aria-hidden="true">&times;</span>
                                                </button>
                                            </div>
                                            <div class="modal-body">
                                                <div class="container-fluid">
                                                    <div class="row">
                                                        <div class="col-12">
                                                            <div class="d-flex justify-content-center">
                                                               <div class="status_imgStatus">
                                                                <p class="status mb-0 mb-1"> <%= resident.accepted === true? 'تمت الموافقة على الطلب' : 'لم تتم الموافقة على الطلب' %></p>
                                                                <div class="imgStatus text-center">
                                                                    <img src="<%= resident.accepted === true? '/assets/Images/Check/right.PNG' : '/assets/Images/Check/Wrong.PNG' %>" title="Image" alt="Image" style="height: 100px; width: 100px; border-radius: 50%"/>
                                                                </div>
                                                               </div>
                                                               
                                                            </div>
                                                        </div>
                                                    </div>
                                                    
                                                </div>
                                            </div>
                                            <div class="modal-footer">
                                                <button type="button" class="btn btn-secondary"
                                                    data-dismiss="modal">إغلاق</button>
                                             
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <% }) %>

        </div>
    </div>
</section>
<!-- Requests Section -->

<!-- Notification -->
<div class="notificationSuccess text-white shadow-lg p-3"></div>
<div class="notificationError text-white shadow-lg p-3"></div>
<!-- Notification -->


<%- contentFor('FooterJs') %>